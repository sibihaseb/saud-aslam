@extends('layouts.master')

@section('styles')
<!-- PRISM CSS -->
<link rel="stylesheet" href="{{ asset('build/assets/libs/prismjs/themes/prism-coy.min.css') }}">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
<style>
    .gallery {
        width: 100%;
        height: 80px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .gallery img {
        width: 20%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px;
        border: 2px solid #fff;
        transition: all ease-out 0.5s;
        cursor: pointer;
        overflow: hidden;
    }

    .gallery img:hover {
        width: 50%;
    }
</style>
@endsection

@section('content')
<div class="container-fluid">
    <!-- Toast Container -->
    <div id="toast-container" aria-live="polite" aria-atomic="true" class="position-fixed top-2 end-0 p-3"
        style="z-index: 1050;">
    </div>
    <nav class="py-4">
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="{{ url('/home') }}">{{ __('Home') }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ __('Projects') }}</li>
        </ol>
    </nav>
    <div class="row">
        <div class="col-xl-12">
            <div class="card custom-card">
                @if (session('success'))
                <div class="alert alert-success">
                    {{ session('success') }}
                </div>
                @endif
                @if (session('error'))
                <div class="alert alert-danger">
                    {{ session('error') }}
                </div>
                @endif
                <div class="card-header justify-content-between">
                    <div class="card-title">
                        {{ __('Project') }}
                    </div>

                    <div class="d-flex align-items-center justify-content-center gap-2">
                        <a href="{{ route('projects.create') }}"
                            class="btn btn-success btn-sm">{{ __('Create Project') }}</a>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        {{ $dataTable->table() }}
                        {{ $dataTable->scripts() }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@include('pages.modal.delete_modal')
@endsection

@section('scripts')
<script>
    var projectId
    $(document).on('click', '.deleteRecord', function() {
        projectId = $(this).attr('id');
        $('#confirmModal').modal('show');
    });
    //Delete Request
    $('#ok_button').click(function() {
        $.ajax({
            url: "/admin/projects/" + projectId,
            type: "DELETE",
            headers: {
                'X-CSRF-TOKEN': $('meta[name="csrf_token"]').attr('content')
            },
            success: function(data) {
                // Get the current page number of the DataTable
                var currentPage = window.LaravelDataTables["project-table"].page
                    .info()
                    .page;
                setTimeout(function() {
                    $('#confirmModal').modal('hide');
                }, 2000);
                window.LaravelDataTables["project-table"].ajax.reload(function(
                    json) {
                    window.LaravelDataTables["project-table"].page(
                            currentPage)
                        .draw(false);
                }, false);
            }
        })
    });
</script>
<!-- PRISM JS -->
<script src="{{ asset('build/assets/libs/prismjs/prism.js') }}"></script>
@vite('resources/assets/js/prism-custom.js')
<!-- JQUERY CDN -->
<script src="https://code.jquery.com/jquery-3.6.1.min.js"
    integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>

<!-- SELECT2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
@endsection